(function($){var Plugin=function(){};Plugin.prototype=$.extend(Plugin.prototype,{name:"zluxSaveElement",options:{url:"",msgSaveElement:"Save Element"},initialize:function(element,options){this.options=$.extend({},this.options,options);var $this=this;$('<a class="btn btn-small save" href="javascript:void(0);"><i class="icon-ok-sign"></i> '+$this.options.msgSaveElement+"</a>").on("click",function(){var button=$(this).addClass("btn-working"),postData=button.closest(".element").find("input, textarea").serializeArray();
$.post($this.options.url+"&task=saveelement",postData,function(data){button.removeClass("btn-working")})}).appendTo(element.find(".btn-toolbar"))}});$.fn[Plugin.prototype.name]=function(){var args=arguments;var method=args[0]?args[0]:null;return this.each(function(){var element=$(this);if(Plugin.prototype[method]&&element.data(Plugin.prototype.name)&&method!="initialize")element.data(Plugin.prototype.name)[method].apply(element.data(Plugin.prototype.name),Array.prototype.slice.call(args,1));else if(!method||
$.isPlainObject(method)){var plugin=new Plugin;if(Plugin.prototype["initialize"])plugin.initialize.apply(plugin,$.merge([element],args));element.data(Plugin.prototype.name,plugin)}else $.error("Method "+method+" does not exist on jQuery."+Plugin.name)})}})(jQuery);
(function($){var Plugin=function(){};Plugin.prototype=$.extend(Plugin.prototype,{name:"zluxBrowseFile",options:{url:"",path:"images"},initialize:function(input,options){this.options=$.extend({},this.options,options);var $this=this,JRoot=location.href.match(/^(.+)administrator\/index\.php.*/i)[1];input.wrap('<div class="zlux-finder"><div /></div>').zluxDialog({title:"Dialog title",width:600,height:400,classes:"zlux-finder"},function(dialog){dialog.content.zluxFinder({dialog:dialog,url:$this.options.url,
path:$this.options.path});dialog.content.on("click",".item.file a",function(){input.val($(this).closest(".item").data("path"))&&input.trigger("change")})});var preview=$('<div class="file-preview zl-bootstrap" />').append($('<img class="img-polaroid" />')).appendTo(input.parent());input.on("change",function(){preview.find("img").attr("src",JRoot+input.val())}).trigger("change");$("<span>").addClass("input-cancel").insertAfter(input).click(function(){input.val("")})}});$.fn[Plugin.prototype.name]=
function(){var args=arguments;var method=args[0]?args[0]:null;return this.each(function(){var element=$(this);if(Plugin.prototype[method]&&element.data(Plugin.prototype.name)&&method!="initialize")element.data(Plugin.prototype.name)[method].apply(element.data(Plugin.prototype.name),Array.prototype.slice.call(args,1));else if(!method||$.isPlainObject(method)){var plugin=new Plugin;if(Plugin.prototype["initialize"])plugin.initialize.apply(plugin,$.merge([element],args));element.data(Plugin.prototype.name,
plugin)}else $.error("Method "+method+" does not exist on jQuery."+Plugin.name)})}})(jQuery);
(function($){var Plugin=function(){};Plugin.prototype=$.extend(Plugin.prototype,{name:"zluxFinder",options:{dialog:{},url:"",path:"images",open:"open",filemanager:true},initialize:function(parent,options){this.options=$.extend({},this.options,options);var $this=this,$open=$this.options.open;parent.data("path",this.options.path).bind("zluxFinder.retrieve",retrieve).trigger("zluxFinder.retrieve");function retrieve(e){e.preventDefault();var item=$(this).closest(".zlux-dialog li",parent);if(!item.length)item=
parent;if(!item.hasClass("file"))if(item.hasClass($open)&&!item.hasClass("reload"))item.removeClass($open).children("ul").slideUp();else{item.addClass("loading");$.post($this.options.url+"&controller=zlframework&task=JSONfiles",{path:item.data("path")},function(itemsData){item.removeClass("loading").addClass($open);$this.options.dialog.loaded();item.children().remove("ul.items");if(!itemsData||itemsData.msg);else{$this.buildItemsTree(itemsData,item);item.find("ul a").on("click",retrieve).on("click",
function(){$(this).closest(".zlux-dialog").find(".selected").removeClass("selected");$(this).closest(".item").addClass("selected")});item.children("ul").slideDown();if(!item.hasClass("reload")||!item.children("ul").length);else;if($this.options.filemanager){parent.data("toolbar-initialized")||($('<span class="root-folder tools" />').append($('<span class="zl-btn-small refresh action" title="Refresh" />').bind("click",function(){item.addClass("reload").find("li").addClass("loading");parent.trigger("zluxFinder.retrieve")})).append($('<span class="zl-btn-small plupload action" title="'+
filesPro.translate("Upload files into the main folder")+'" />').bind("click",function(){$this.plupload($(this),"",function(){item.addClass("reload").find("li").addClass("loading");parent.trigger("zluxFinder.retrieve")})})).append($('<span class="zl-btn-small add action" title="'+filesPro.translate("Create a new folder into the main folder")+'" />').bind("click",function(){$this.Prompt(filesPro.translate("Input a name for the new folder"),filesPro.translate("MyFolder"),$(this),function(response){response&&
item.find("li").addClass("loading")&&$.post($this.options.url+"&method=newfolder",{path:"",newfolder:response},function(){item.addClass("reload");a.trigger("zluxFinder.retrieve")},"json")})})).prependTo(parent.closest(".ui-dialog").find(".ui-dialog-titlebar")),parent.data("toolbar-initialized",!0));$(".ui-dialog").find(".tools span").qtip({position:{my:"bottom left",at:"top center"},show:{delay:700},style:"ui-tooltip-custom ui-tooltip-light ui-tooltip-rounded ui-tooltip-dialogue"})}}},"json")}}},
buildItemsTree:function(itemsData,item){var $this=this;item.append('<ul class="items" />').children("ul").hide();$.each(itemsData,function(h,g){var newItem=$('<li class="item" />').addClass(g.type).data("path",g.path).data("size",g.size);if($this.options.filemanager)$('<div class="btns"><a href="#">'+g.name+"</a></div>").append($('<span class="tools" />').append(g.type=="folder"&&$('<span class="zl-btn-small plupload action" title="'+filesPro.translate("Upload files into this folder")+'" />').bind("click",
function(){var clicked=$(this);$this.plupload(clicked.closest("li"),g.path,function(){clicked.closest("li").addClass("reload");clicked.closest(".finderpro .btns").find("a").trigger("click")})})).append(g.type=="folder"&&$('<span class="zl-btn-small add action" title="'+filesPro.translate("Create a new subfolder")+'" />').bind("click",function(){var clicked=$(this);$this.Prompt(filesPro.translate("Input a name for the new folder"),filesPro.translate("MyFolder"),clicked.closest("li"),function(response){response&&
clicked.closest("li").addClass("reload loading")&&$.post($this.options.url+"&method=newfolder",{path:g.path,newfolder:response},function(){clicked.closest(".btns").find("a").trigger("click")},"json")})})).append($('<span class="zl-btn-small delete action" title="'+filesPro.translate("Delete")+'" />').click(function(){var clicked=$(this);$this.Confirm(filesPro.translate("You are about to delete")+' "'+g.name+'"',clicked.closest("li"),function(response){response&&clicked.closest("li").addClass("loading")&&
$.post($this.options.url+"&method=delete",{path:g.path},function(){clicked.closest("li").fadeOut(400,function(){clicked.closest("li").remove()})},"json")})}))).appendTo(newItem);newItem.appendTo(item.children("ul"))})},plupload:function(target,path,callback){var $this=this,p=$("<div />").appendTo("body").Plupload({url:$this.options.url,path:path===undefined?"":path,extensions:$this.options.extensions,fileMode:"files",callback:callback});$('<a class="plupload_button plupload_cancel ui-button ui-widget ui-state-default ui-corner-all ui-button-text-icon-primary" />').append($('<span class="ui-button-icon-primary ui-icon ui-icon-circle-close"></span>')).append($('<span class="ui-button-text">'+
filesPro.translate("Cancel")+"</span>")).bind("hover",function(){$(this).toggleClass("ui-state-hover")}).bind("click",function(){$(this).closest(".qtip").qtip("hide");$this.reset()}).appendTo(p.find(".plupload_buttons"));this.dialogue(p,target,"plupload")},dialogue:function(content,target,style){this.reset();target.find(".btns").first().addClass("action");$(target).qtip({content:{text:content},position:{my:"left bottom",at:"top right",viewport:$(window)},show:{ready:true,solo:true,delay:0},hide:false,
style:style+" ui-tooltip-custom ui-tooltip-filespro ui-tooltip-light ui-tooltip-rounded ui-tooltip-dialogue",events:{render:function(event,api){$("button",api.elements.content).click(api.hide)},hide:function(event,api){api.destroy()}}})},Confirm:function(question,target,callback){var message=$("<p />",{text:question}),ok=$("<button />",{text:filesPro.translate("Confirm"),click:function(){callback(true);target.closest(".finderpro").find(".btns").removeClass("action")}}),cancel=$("<button />",{text:filesPro.translate("Cancel"),
click:function(){callback(false);target.closest(".finderpro").find(".btns").removeClass("action")}});this.dialogue(message.add(ok).add(cancel),target)},Prompt:function(question,placeholder,target,callback){var message=$("<p />",{text:question}),input=$("<input />",{val:placeholder}),ok=$("<button />",{text:filesPro.translate("Confirm"),click:function(){callback(input.val());target.closest(".finderpro").find(".btns").removeClass("action")}}),cancel=$("<button />",{text:filesPro.translate("Cancel"),
click:function(){callback(null);target.closest(".finderpro").find(".btns").removeClass("action")}});this.dialogue(message.add(input).add(ok).add(cancel),target)},reset:function(){$(".finderpro").find(".btns").removeClass("action");$(".qtip").qtip("hide")}});$.fn[Plugin.prototype.name]=function(){var args=arguments;var method=args[0]?args[0]:null;return this.each(function(){var element=$(this);if(Plugin.prototype[method]&&element.data(Plugin.prototype.name)&&method!="initialize")element.data(Plugin.prototype.name)[method].apply(element.data(Plugin.prototype.name),
Array.prototype.slice.call(args,1));else if(!method||$.isPlainObject(method)){var plugin=new Plugin;if(Plugin.prototype["initialize"])plugin.initialize.apply(plugin,$.merge([element],args));element.data(Plugin.prototype.name,plugin)}else $.error("Method "+method+" does not exist on jQuery."+Plugin.name)})}})(jQuery);
(function($){var Plugin=function(){};Plugin.prototype=$.extend(Plugin.prototype,{name:"zluxDialog",options:{width:"300",height:"150",title:"Dialog",classes:""},initialize:function(input,options,callback){this.options=$.extend({},this.options,options);var $this=this;this.content=$('<div><span class="zlux-loader-horiz" /></div>').insertAfter(input);var $this=this,h=$this.content.dialog($.extend({autoOpen:!1,resizable:!1,width:$this.options.width,height:$this.options.height,dialogClass:"zlux-dialog zl-bootstrap"+
($this.options.classes?" "+$this.options.classes:""),open:function(){h.position({of:f,my:"left top",at:"right bottom"})},dragStop:function(event,ui){window.qtip&&$(".qtip").qtip("reposition")},close:function(event,ui){window.qtip&&$(".qtip").qtip("hide")}},$this.options)).dialog("widget"),f=$('<span title="'+$this.options.title+'" class="files" />').insertAfter(input).bind("click",function(){$this.content.dialog($this.content.dialog("isOpen")?"close":"open");if(!$(this).data("initialized"))callback($this);
$(this).data("initialized",!0)});$("html").bind("mousedown",function(event){$this.content.dialog("isOpen")&&!f.is(event.target)&&!h.find(event.target).length&&!$(event.target).closest(".qtip").length&&$this.content.dialog("close")})},loaded:function(){this.content.find(".zlux-loader-horiz").remove()},close:function(){this.content.dialog("close")}});$.fn[Plugin.prototype.name]=function(){var args=arguments;var method=args[0]?args[0]:null;return this.each(function(){var element=$(this);if(Plugin.prototype[method]&&
element.data(Plugin.prototype.name)&&method!="initialize")element.data(Plugin.prototype.name)[method].apply(element.data(Plugin.prototype.name),Array.prototype.slice.call(args,1));else if(!method||$.isPlainObject(method)){var plugin=new Plugin;if(Plugin.prototype["initialize"])plugin.initialize.apply(plugin,$.merge([element],args));element.data(Plugin.prototype.name,plugin)}else $.error("Method "+method+" does not exist on jQuery."+Plugin.name)})}})(jQuery);